<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Empirical Application Vignette • hdIndep</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Empirical Application Vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hdIndep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/hdIndep.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/mauolivares/hdIndep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Empirical Application Vignette</h1>
                        <h4 data-toc-skip class="author">Mauricio
Olivares, Tomasz Olma, Daniel Wilhelm</h4>
            
            <h4 data-toc-skip class="date">2025-02-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mauolivares/hdIndep/blob/HEAD/vignettes/hdIndep.Rmd"><code>vignettes/hdIndep.Rmd</code></a></small>
      <div class="d-none name"><code>hdIndep.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette illustrates how our stepdown procedure can be applied
to real gene expression data to identify transcripts associated with
cell cycle phases. We use publicly available HeLa cell cycle data from
Hughes et al. (2009).</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Install and load required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"GEOquery"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">required_packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"readxl"</span>, <span class="st">"compiler"</span>, <span class="st">"ggplot2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">required_packages</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Load <code>hdIndep</code> package</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mauolivares/hdIndep">hdIndep</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-acquisition">Data Acquisition<a class="anchor" aria-label="anchor" href="#data-acquisition"></a>
</h2>
<p>We analyze the GEO dataset GSE11923:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gse</span> <span class="op">&lt;-</span> <span class="fu">GEOquery</span><span class="fu">::</span><span class="fu"><a href="http://seandavi.github.io/GEOquery/reference/getGEO.html" class="external-link">getGEO</a></span><span class="op">(</span><span class="st">"GSE11923"</span>, GSEMatrix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">expr_data</span> <span class="op">&lt;-</span> <span class="fu">exprs</span><span class="op">(</span><span class="va">gse</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>You may download data from the HeLa Cell Cycle (from Hughes et
al. 2009) See more information about the dataset here: <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE11923" class="external-link uri">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE11923</a></p>
<p>Each column in <code>expr_data</code> corresponds to a sample (GSM
ID=GEO Sample). Each row corresponds to a probe set measuring expression
in that sample. The values in <code>expr_data</code> are expression
intensity values for each probe set in each sample.</p>
</div>
<div class="section level2">
<h2 id="running-the-stepdown-procedure">Running the Stepdown Procedure<a class="anchor" aria-label="anchor" href="#running-the-stepdown-procedure"></a>
</h2>
<p>Define parameters for the stepdown procedure:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">expr_data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># Sample size</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">expr_data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># Number of variables</span></span>
<span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/block_size.html">block_size</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="co"># Block size</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># Number of bootstrap replications</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="co"># Significance level</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="op">(</span><span class="va">q</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># Number of blocks</span></span>
<span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"bmb1"</span> <span class="co"># Test statistic used in the multiplier bootstrap</span></span>
<span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span></code></pre></div>
<p>Reshape the data so that we can run the stepdown procedure
automatically.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">expr_data</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, D <span class="op">=</span> <span class="va">D</span><span class="op">)</span></span></code></pre></div>
<p>Run the stepdown procedure using the BMB1 studentized version of the
test statistic</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stud</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stepdown_RomanoWolf.html">stepdown_RomanoWolf</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">q</span>, <span class="va">B</span>, <span class="va">alpha</span>, <span class="va">type</span>, <span class="va">seed</span>, steps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">stud</span><span class="op">$</span><span class="va">rejected_total</span><span class="op">)</span> <span class="co"># Number of rejected hypotheses</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">stud</span><span class="op">$</span><span class="va">rejected_total</span><span class="op">)</span> <span class="op">/</span>  <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">expr_data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">stud</span><span class="op">$</span><span class="va">counter</span> <span class="co"># Number of steps in the stepdown procedure</span></span></code></pre></div>
<p>Collect the variables that are screened out by the stepdown
procedure. These are the probes that are not independent of the cycle
phase.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">independent_vars</span> <span class="op">&lt;-</span> <span class="va">expr_data</span><span class="op">[</span><span class="va">stud_1</span><span class="op">$</span><span class="va">rejected_total</span>, <span class="op">]</span></span></code></pre></div>
<p>Finally, save the independent variables</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">independent_vars</span>, file <span class="op">=</span> <span class="st">"data/independent_vars.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparing-results-with-hughes-et-al--2009">Comparing Results with Hughes et al. (2009)<a class="anchor" aria-label="anchor" href="#comparing-results-with-hughes-et-al--2009"></a>
</h2>
<div class="section level3">
<h3 id="load-the-probes-that-were-identified-by-hughes-et-al--2009-">Load the probes that were identified by Hughes et al. (2009).<a class="anchor" aria-label="anchor" href="#load-the-probes-that-were-identified-by-hughes-et-al--2009-"></a>
</h3>
<p>Download the pre-processed data from the HeLa Cell Cycle from Hughes
et al. (2009), Table S1, Supporting information: <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC2654964/#pgen.1000442.s012" class="external-link uri">https://pmc.ncbi.nlm.nih.gov/articles/PMC2654964/#pgen.1000442.s012</a></p>
<p>This is an excel file, <code>pgen.1000442.s012.xls</code>, that
contains the transcripts identified by Hughes et al. (2009) that cycle
with a period length of 24 hrs, i.e., that are independent of the cell
cycle phase.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_hughes</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="st">"data/pgen.1000442.s012.xls"</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">hughes2009</span> <span class="op">&lt;-</span> <span class="va">df_hughes</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co"># Extract identified probes as a vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hughes et al. (2009) identified"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">hughes2009</span><span class="op">)</span>, <span class="st">"different</span></span>
<span><span class="st">transcripts in mouse liver that cycle with a period length of 24 hours.\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-transcripts-from-hughes-et-al--2009-with-ours">Compare transcripts from Hughes et al. (2009) with ours<a class="anchor" aria-label="anchor" href="#compare-transcripts-from-hughes-et-al--2009-with-ours"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw_oow2025</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data/independent_vars.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Extract only the first column</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">oow2025</span> <span class="op">&lt;-</span> <span class="va">raw_oow2025</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>  <span class="co"># Extract identified probes as a vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Our stepdown method identified"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">oow2025</span><span class="op">)</span>,</span>
<span>    <span class="st">"different transcripts.\n"</span><span class="op">)</span></span></code></pre></div>
<p>Compare the two sets of identified transcripts</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">common</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="va">hughes2009</span>, <span class="va">oow2025</span><span class="op">)</span></span>
<span><span class="va">unique_oow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">oow2025</span>, <span class="va">hughes2009</span><span class="op">)</span></span>
<span><span class="va">unique_hughes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">hughes2009</span>, <span class="va">oow2025</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"There are"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">common</span><span class="op">)</span>, <span class="st">"transcripts that are common to both sets.\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"There are"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">unique_oow</span><span class="op">)</span>, <span class="st">"transcripts unique to our method.\n"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="unique-transcripts">Unique Transcripts<a class="anchor" aria-label="anchor" href="#unique-transcripts"></a>
</h2>
<p>Take a random sample of unique transcripts identified by our
procedure</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Here are 6 randomly selected transcripts identified by our procedure:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">id_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">unique_oow</span>, <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p>What are these transcripts? Extract the platform (GPL) ID</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gpl_id</span> <span class="op">&lt;-</span> <span class="fu">annotation</span><span class="op">(</span><span class="va">gse</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Check the platform ID and download the annotation file for the
platform</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gpl_id</span><span class="op">)</span></span>
<span><span class="va">gpl</span> <span class="op">&lt;-</span> <span class="fu">getGEO</span><span class="op">(</span><span class="va">gpl_id</span><span class="op">)</span></span></code></pre></div>
<p>Extract annotation table and check available column names</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gpl_table</span> <span class="op">&lt;-</span> <span class="fu">Table</span><span class="op">(</span><span class="va">gpl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">gpl_table</span><span class="op">)</span></span></code></pre></div>
<p>Select relevant columns</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probe_to_gene</span> <span class="op">&lt;-</span> <span class="va">gpl_table</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Gene Symbol"</span>, <span class="st">"Gene Title"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Match with id_sample (your probe set IDs) and add original Probe Set
IDs</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_info</span> <span class="op">&lt;-</span> <span class="va">probe_to_gene</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">id_sample</span>, <span class="va">probe_to_gene</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gene Symbol"</span>, <span class="st">"Gene Title"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">gene_info</span><span class="op">$</span><span class="va">ProbeSetID</span> <span class="op">&lt;-</span> <span class="va">id_sample</span></span></code></pre></div>
<p>Print the subset</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gene_info</span><span class="op">)</span></span></code></pre></div>
<p>Replace id_sample with Gene Symbols for plots</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id_sample_symbol</span> <span class="op">&lt;-</span> <span class="va">gene_info</span><span class="op">$</span><span class="va">Gene.Symbol</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization-of-selected-transcripts">Visualization of Selected Transcripts<a class="anchor" aria-label="anchor" href="#visualization-of-selected-transcripts"></a>
</h2>
<p>Convert raw_oow2025 to a matrix</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">raw_oow2025</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">raw_oow2025</span><span class="op">)</span></span></code></pre></div>
<p>Find id_sample in raw_oow2025 and return all the columns as a data
frame</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id_sample_df</span> <span class="op">&lt;-</span> <span class="va">raw_oow2025</span><span class="op">[</span><span class="va">raw_oow2025</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">id_sample</span>, <span class="op">]</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">id_sample_df</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">as.numeric</span><span class="op">)</span></span></code></pre></div>
<p>Visuals</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_vals</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create a data frame for the current row</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_vals</span>, y <span class="op">=</span> <span class="va">plot_data</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Generate plot</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Dashed line</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span> <span class="op">+</span>      <span class="co"># Blue circles</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>                 <span class="co"># Minimal theme</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Hour"</span>, y <span class="op">=</span> <span class="st">"Intensity Level"</span><span class="op">)</span>  <span class="co"># Updated axis labels</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mauricio Olivares, Tomasz Olma, Daniel Wilhelm.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
